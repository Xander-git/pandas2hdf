---
alwaysApply: true
---
# Scope
- Only modify the current file or explicit @selection unless a PLAN is provided and approved.
- Keep diffs minimal and reversible.

# Style
- Use type hints and Google-style docstrings.
- Match ruff/black/mypy settings from pyproject.

# Testing
- If a change is requested, write/adjust tests first. Show pytest -q output.
- Do not remove tests without replacement.

# Dependencies
- Do not add new deps unless I write: ALLOW_DEP:<name>.
- Prefer stdlib and existing libs.

# Security
- Never include secrets. Do not add network/subprocess without ALLOW_NET/ALLOW_SUBPROCESS.

# Explanations
- For nontrivial edits: provide a 3â€“5 bullet rationale and a one-paragraph migration note if API changes.

# Refactors
- Provide a PLAN with steps and risks for multi-file refactors. Execute only after approval.

# Docs
- Update README and docstrings when behavior or CLI changes.

# Commits
- Conventional commits. One logical change per commit.